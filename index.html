
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fallout Simulator v2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    label { display: block; margin-top: 1em; }
    select, input, button { padding: 0.4em; margin-top: 0.2em; width: 100%; max-width: 300px; }
    #map { height: 60vh; width: 100%; margin-top: 1em; }
  </style>
</head>
<body>
  <h2>üåç Fallout Simulator (v2)</h2>

  <label for="country">Select Country:</label>
  <select id="country"><option value="">-- Select Country --</option></select>

  <label for="plant">Nuclear Plant:</label>
  <select id="plant"><option value="">-- Select Plant --</option></select>

  <label for="scenario">Scenario Type:</label>
  <select id="scenario">
    <option value="meltdown">Reactor Meltdown</option>
    <option value="steam_fire">Steam Explosion + Fire</option>
    <option value="attack">High-Temperature Attack</option>
  </select>

  <label for="windDir">Wind Direction (¬∞):</label>
  <input type="number" id="windDir" placeholder="e.g. 90" />

  <label for="windSpeed">Wind Speed (km/h):</label>
  <input type="number" id="windSpeed" placeholder="e.g. 30" />

  <label for="temp">Temperature:</label>
  <select id="temp">
    <option value="cold">Cold</option>
    <option value="normal" selected>Normal</option>
    <option value="hot">Hot</option>
  </select>

  <label for="precip">Precipitation:</label>
  <select id="precip">
    <option value="none" selected>None</option>
    <option value="rain">Rain</option>
    <option value="snow">Snow</option>
  </select>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const countrySel = document.getElementById("country");
    const plantSel = document.getElementById("plant");
    let map = L.map('map').setView([20, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    let allPlants = [];

    fetch("nuclear_plants.json")
      .then(res => res.json())
      .then(data => {
        allPlants = data.features;
        const countries = [...new Set(allPlants.map(p => p.properties.Country))].sort();
        for (let c of countries) {
          let opt = document.createElement("option");
          opt.value = c;
          opt.textContent = c;
          countrySel.appendChild(opt);
        }
      });

    countrySel.addEventListener("change", () => {
      const selectedCountry = countrySel.value;
      plantSel.innerHTML = '<option value="">-- Select Plant --</option>';
      const filtered = allPlants.filter(p => p.properties.Country === selectedCountry);
      for (let plant of filtered) {
        let opt = document.createElement("option");
        opt.value = `${plant.geometry.coordinates[1]},${plant.geometry.coordinates[0]}`;
        opt.textContent = plant.properties.Name;
        plantSel.appendChild(opt);
      }
    });

    plantSel.addEventListener("change", () => {
      const [lat, lng] = plantSel.value.split(',').map(parseFloat);
      map.setView([lat, lng], 8);
      L.marker([lat, lng]).addTo(map);
    });
  </script>
</body>
</html>
