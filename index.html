
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fallout Simulator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    #map { height: 70vh; width: 100%; }
    .controls { padding: 1em; background: #f5f5f5; }
    select, input { margin: 0.5em 0; padding: 0.5em; width: 100%; max-width: 300px; }
  </style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
<div class="controls">
  <h2>üåç Fallout Simulator</h2>

  <label for="country">Select Country:</label>
  <select id="country">
    <option value="">-- Select --</option>
  </select>

  <label for="plant">Nuclear Plant:</label>
  <select id="plant"></select>

  <label for="scenario">Scenario Type:</label>
  <select id="scenario">
    <option value="meltdown">Reactor Meltdown</option>
    <option value="steam">Steam Explosion and Fire</option>
    <option value="attack">High-Temperature Attack</option>
  </select>

  <label for="windSpeed">Wind Speed (km/h):</label>
  <input type="number" id="windSpeed" value="20" />

  <label for="windDirection">Wind Direction (¬∞):</label>
  <input type="number" id="windDirection" value="90" />
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
let map = L.map('map').setView([20, 0], 2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 18,
}).addTo(map);

let plantsData = [];

fetch('nuclear_plants.json')
  .then(res => res.json())
  .then(data => {
    plantsData = data.features;

    const countrySel = document.getElementById('country');
    const plantSel = document.getElementById('plant');

    const countrySet = [...new Set(plantsData.map(p => p.properties.Country))].sort();
    for (let c of countrySet) {
      const opt = document.createElement('option');
      opt.value = c;
      opt.textContent = c;
      countrySel.appendChild(opt);
    }

    countrySel.addEventListener('change', () => {
      const selected = countrySel.value;
      plantSel.innerHTML = '';
      const filtered = plantsData.filter(p => p.properties.Country === selected);
      filtered.forEach(p => {
        const opt = document.createElement('option');
        const lat = p.geometry.coordinates[1];
        const lon = p.geometry.coordinates[0];
        opt.value = `${lat},${lon}`;
        opt.textContent = p.properties.Name;
        plantSel.appendChild(opt);
      });
    });

    plantSel.addEventListener('change', () => {
      const coords = plantSel.value.split(',');
      const lat = parseFloat(coords[0]);
      const lon = parseFloat(coords[1]);
      map.setView([lat, lon], 7);
      L.marker([lat, lon]).addTo(map);
    });

  })
  .catch(err => {
    console.error("Failed to load JSON:", err);
  });
</script>
</body>
</html>
